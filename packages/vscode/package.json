{
  "name": "sentriflow-vscode",
  "displayName": "SentriFlow Compliance Validator",
  "description": "Validate network configurations against security best practices and compliance rules. Supports Cisco, Juniper, Arista, and more.",
  "version": "0.3.3",
  "license": "Apache-2.0",
  "qna": "marketplace",
  "privacy": {
    "termsOfService": "https://sentriflow.com.au/terms",
    "privacyPolicy": "https://sentriflow.com.au/privacy",
    "dataCollection": {
      "machineId": {
        "collected": true,
        "purpose": "License binding for commercial encrypted rule packs",
        "library": "node-machine-id",
        "stored": "Local only (VS Code secrets storage)",
        "transmitted": "Hash used for license validation API calls when using commercial features",
        "optional": "Only collected when encrypted pack features are used"
      },
      "telemetry": {
        "collected": false,
        "details": "No telemetry data is collected or transmitted"
      }
    },
    "thirdPartyDisclosure": "When using commercial features, a hardware-derived identifier is transmitted to SentriFlow servers for license validation. This identifier cannot be used to personally identify you."
  },
  "publisher": "sentriflow",
  "engines": {
    "vscode": "^1.80.0"
  },
  "main": "./dist/extension.js",
  "categories": [
    "Other",
    "Linters"
  ],
  "keywords": [
    "network",
    "compliance",
    "security",
    "configuration",
    "validation",
    "cisco",
    "juniper",
    "arista",
    "best-practices"
  ],
  "activationEvents": [
    "onLanguage:network-config",
    "onLanguage:plaintext",
    "onView:sentriflowRules"
  ],
  "contributes": {
    "viewsContainers": {
      "activitybar": [
        {
          "id": "sentriflow",
          "title": "SentriFlow",
          "icon": "resources/sentriflow-icon.svg"
        }
      ]
    },
    "views": {
      "sentriflow": [
        {
          "id": "sentriflowRules",
          "name": "Rules",
          "type": "tree"
        },
        {
          "id": "sentriflowIPAddresses",
          "name": "IP Addresses",
          "type": "tree"
        },
        {
          "id": "sentriflowLicense",
          "name": "License",
          "type": "tree"
        },
        {
          "id": "sentriflowSettings",
          "name": "Settings",
          "type": "webview"
        }
      ]
    },
    "languages": [
      {
        "id": "network-config",
        "aliases": [
          "Network Config",
          "Cisco IOS",
          "Juniper"
        ],
        "extensions": [
          ".conf",
          ".cfg",
          ".ios",
          ".junos"
        ],
        "filenames": [
          "startup-config",
          "running-config"
        ],
        "configuration": "./language-configuration.json"
      }
    ],
    "commands": [
      {
        "command": "sentriflow.scan",
        "title": "Scan Configuration",
        "category": "SentriFlow",
        "icon": "$(search)"
      },
      {
        "command": "sentriflow.scanSelection",
        "title": "Scan Selected Text",
        "category": "SentriFlow",
        "icon": "$(selection)"
      },
      {
        "command": "sentriflow.setLanguage",
        "title": "Set as Network Config",
        "category": "SentriFlow"
      },
      {
        "command": "sentriflow.toggleDebug",
        "title": "Toggle Debug Logging",
        "category": "SentriFlow"
      },
      {
        "command": "sentriflow.selectVendor",
        "title": "Select Vendor",
        "category": "SentriFlow",
        "icon": "$(server)"
      },
      {
        "command": "sentriflow.showRulePacks",
        "title": "Show Rule Packs",
        "category": "SentriFlow",
        "icon": "$(package)"
      },
      {
        "command": "sentriflow.togglePack",
        "title": "Enable/Disable Pack...",
        "category": "SentriFlow",
        "icon": "$(package)"
      },
      {
        "command": "sentriflow.toggleVendor",
        "title": "Enable/Disable Vendor...",
        "category": "SentriFlow",
        "icon": "$(server)"
      },
      {
        "command": "sentriflow.disableRuleById",
        "title": "Disable Rule...",
        "category": "SentriFlow",
        "icon": "$(circle-slash)"
      },
      {
        "command": "sentriflow.enableRuleById",
        "title": "Enable Disabled Rule...",
        "category": "SentriFlow",
        "icon": "$(check)"
      },
      {
        "command": "sentriflow.showDisabled",
        "title": "Show All Disabled Items",
        "category": "SentriFlow",
        "icon": "$(list-flat)"
      },
      {
        "command": "sentriflow.filterTagType",
        "title": "Filter Tags by Type...",
        "category": "SentriFlow",
        "icon": "$(filter)"
      },
      {
        "command": "sentriflow.focusRulesView",
        "title": "Show Rules Panel",
        "category": "SentriFlow",
        "icon": "$(list-tree)"
      },
      {
        "command": "sentriflow.disableTreeItem",
        "title": "Disable",
        "category": "SentriFlow",
        "icon": "$(pass-filled)"
      },
      {
        "command": "sentriflow.enableTreeItem",
        "title": "Enable",
        "category": "SentriFlow",
        "icon": "$(circle-large-outline)"
      },
      {
        "command": "sentriflow.copyRuleId",
        "title": "Copy Rule ID",
        "category": "SentriFlow",
        "icon": "$(clippy)"
      },
      {
        "command": "sentriflow.viewRuleDetails",
        "title": "View Details",
        "category": "SentriFlow",
        "icon": "$(info)"
      },
      {
        "command": "sentriflow.refreshRulesTree",
        "title": "Refresh Rules",
        "category": "SentriFlow",
        "icon": "$(refresh)"
      },
      {
        "command": "sentriflow.refreshIPTree",
        "title": "Refresh IP Addresses",
        "category": "SentriFlow",
        "icon": "$(refresh)"
      },
      {
        "command": "sentriflow.copyAllIPs",
        "title": "Copy All IP Addresses",
        "category": "SentriFlow",
        "icon": "$(clippy)"
      },
      {
        "command": "sentriflow.copyIPValue",
        "title": "Copy",
        "category": "SentriFlow",
        "icon": "$(clippy)"
      },
      {
        "command": "sentriflow.copyIPCategory",
        "title": "Copy All in Category",
        "category": "SentriFlow",
        "icon": "$(clippy)"
      },
      {
        "command": "sentriflow.filterByCategory",
        "title": "Filter Diagnostics by Category",
        "category": "SentriFlow",
        "icon": "$(filter)"
      },
      {
        "command": "sentriflow.enterLicenseKey",
        "title": "Enter License Key",
        "category": "SentriFlow",
        "icon": "$(key)"
      },
      {
        "command": "sentriflow.clearLicenseKey",
        "title": "Clear License Key",
        "category": "SentriFlow",
        "icon": "$(trash)"
      },
      {
        "command": "sentriflow.showLicenseStatus",
        "title": "Show License Status",
        "category": "SentriFlow",
        "icon": "$(info)"
      },
      {
        "command": "sentriflow.checkForUpdates",
        "title": "Check for Pack Updates",
        "category": "SentriFlow",
        "icon": "$(cloud-download)"
      },
      {
        "command": "sentriflow.downloadUpdates",
        "title": "Download Pack Updates",
        "category": "SentriFlow",
        "icon": "$(cloud-download)"
      },
      {
        "command": "sentriflow.reloadPacks",
        "title": "Reload Rule Packs",
        "category": "SentriFlow",
        "icon": "$(refresh)"
      },
      {
        "command": "sentriflow.showPackStatus",
        "title": "Show Pack Status",
        "category": "SentriFlow",
        "icon": "$(package)"
      },
      {
        "command": "sentriflow.scanBulk",
        "title": "Scan with SentriFlow",
        "category": "SentriFlow",
        "icon": "$(search)"
      }
    ],
    "menus": {
      "editor/context": [
        {
          "command": "sentriflow.scan",
          "group": "1_sentriflow@1",
          "when": "editorTextFocus"
        },
        {
          "command": "sentriflow.scanSelection",
          "group": "1_sentriflow@2",
          "when": "editorHasSelection"
        }
      ],
      "explorer/context": [
        {
          "command": "sentriflow.scanBulk",
          "group": "navigation",
          "when": "explorerResourceIsFolder"
        },
        {
          "command": "sentriflow.scanBulk",
          "group": "navigation",
          "when": "resourceExtname =~ /^\\.(conf|config|cfg|ios|junos|txt|eos|nxos|routeros|vyos|panos|sros|vrp|exos|voss)$/"
        }
      ],
      "commandPalette": [
        {
          "command": "sentriflow.scanSelection",
          "when": "editorHasSelection"
        },
        {
          "command": "sentriflow.scanBulk",
          "when": "false"
        },
        {
          "command": "sentriflow.disableTreeItem",
          "when": "false"
        },
        {
          "command": "sentriflow.enableTreeItem",
          "when": "false"
        },
        {
          "command": "sentriflow.copyRuleId",
          "when": "false"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "false"
        },
        {
          "command": "sentriflow.refreshRulesTree",
          "when": "false"
        },
        {
          "command": "sentriflow.refreshIPTree",
          "when": "false"
        },
        {
          "command": "sentriflow.copyIPValue",
          "when": "false"
        },
        {
          "command": "sentriflow.copyIPCategory",
          "when": "false"
        },
        {
          "command": "sentriflow.copyAllIPs",
          "when": "false"
        }
      ],
      "view/title": [
        {
          "command": "sentriflow.refreshRulesTree",
          "when": "view == sentriflowRules",
          "group": "navigation"
        },
        {
          "command": "sentriflow.refreshIPTree",
          "when": "view == sentriflowIPAddresses",
          "group": "navigation@1"
        },
        {
          "command": "sentriflow.copyAllIPs",
          "when": "view == sentriflowIPAddresses",
          "group": "navigation@2"
        }
      ],
      "view/item/context": [
        {
          "command": "sentriflow.disableTreeItem",
          "when": "view == sentriflowRules && viewItem =~ /^(pack|vendor|category|rule)-enabled$/",
          "group": "inline@1"
        },
        {
          "command": "sentriflow.enableTreeItem",
          "when": "view == sentriflowRules && viewItem =~ /^(pack|vendor|category|rule)-disabled$/",
          "group": "inline@1"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "view == sentriflowRules && viewItem =~ /^rule-/",
          "group": "inline@2"
        },
        {
          "command": "sentriflow.disableTreeItem",
          "when": "view == sentriflowRules && viewItem =~ /^(pack|vendor|category|rule)-enabled$/",
          "group": "1_toggle@1"
        },
        {
          "command": "sentriflow.enableTreeItem",
          "when": "view == sentriflowRules && viewItem =~ /^(pack|vendor|category|rule)-disabled$/",
          "group": "1_toggle@1"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "view == sentriflowRules && viewItem =~ /^pack-/",
          "group": "2_view@1"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "view == sentriflowRules && viewItem =~ /^vendor-/",
          "group": "2_view@1"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "view == sentriflowRules && viewItem =~ /^category-/",
          "group": "2_view@1"
        },
        {
          "command": "sentriflow.copyRuleId",
          "when": "view == sentriflowRules && viewItem =~ /^rule-/",
          "group": "2_copy@1"
        },
        {
          "command": "sentriflow.viewRuleDetails",
          "when": "view == sentriflowRules && viewItem =~ /^rule-/",
          "group": "3_view@1"
        },
        {
          "command": "sentriflow.copyIPValue",
          "when": "view == sentriflowIPAddresses && viewItem =~ /^ip-(address|subnet)$/",
          "group": "inline@1"
        },
        {
          "command": "sentriflow.copyIPValue",
          "when": "view == sentriflowIPAddresses && viewItem =~ /^ip-(address|subnet)$/",
          "group": "1_copy@1"
        },
        {
          "command": "sentriflow.copyIPCategory",
          "when": "view == sentriflowIPAddresses && viewItem =~ /^ip-category-/",
          "group": "inline@1"
        },
        {
          "command": "sentriflow.copyIPCategory",
          "when": "view == sentriflowIPAddresses && viewItem =~ /^ip-category-/",
          "group": "1_copy@1"
        }
      ]
    },
    "configuration": {
      "title": "SentriFlow",
      "properties": {
        "sentriflow.defaultVendor": {
          "type": "string",
          "enum": [
            "auto",
            "arista-eos",
            "aruba-aoscx",
            "aruba-aosswitch",
            "aruba-wlc",
            "cisco-ios",
            "cisco-nxos",
            "cumulus-linux",
            "extreme-exos",
            "extreme-voss",
            "fortinet-fortigate",
            "huawei-vrp",
            "juniper-junos",
            "mikrotik-routeros",
            "nokia-sros",
            "paloalto-panos",
            "vyos-vyos"
          ],
          "enumDescriptions": [
            "Auto-detect vendor from configuration content",
            "Arista EOS (datacenter switch)",
            "Aruba AOS-CX (modern campus switch)",
            "Aruba AOS-Switch/ProVision (legacy switch)",
            "Aruba Wireless LAN Controller",
            "Cisco IOS/IOS-XE (indentation-based)",
            "Cisco NX-OS (datacenter switch, feature commands)",
            "NVIDIA Cumulus Linux (NCLU/NVUE)",
            "Extreme Networks EXOS",
            "Extreme Networks VOSS (Fabric Connect)",
            "Fortinet FortiGate (FortiOS)",
            "Huawei VRP",
            "Juniper JunOS (brace-based hierarchy)",
            "MikroTik RouterOS",
            "Nokia SR OS",
            "Palo Alto PAN-OS",
            "VyOS/EdgeOS"
          ],
          "default": "auto",
          "description": "Default vendor for configuration parsing. Use 'auto' to detect automatically, or select a specific vendor."
        },
        "sentriflow.showVendorInStatusBar": {
          "type": "boolean",
          "default": true,
          "description": "Show detected vendor name in the status bar"
        },
        "sentriflow.enableDefaultRules": {
          "type": "boolean",
          "default": true,
          "description": "Enable built-in default rules. Set to false to use only external rule packs."
        },
        "sentriflow.blockedPacks": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "List of rule pack names to block from loading (e.g., [\"sf-essentials\"])"
        },
        "sentriflow.packVendorOverrides": {
          "type": "object",
          "default": {},
          "description": "Per-pack vendor settings. Use 'SENTRIFLOW: Show Rule Packs' command to manage.",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "disabledVendors": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        },
        "sentriflow.disabledRules": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "List of rule IDs to disable globally (e.g., [\"SEC-001\", \"NET-002\"])"
        },
        "sentriflow.treeGrouping": {
          "type": "string",
          "enum": [
            "vendor",
            "category",
            "category-vendor",
            "vendor-category"
          ],
          "enumDescriptions": [
            "Pack → Vendor → Rules (default)",
            "Pack → Category → Rules",
            "Pack → Category → Vendor → Rules",
            "Pack → Vendor → Category → Rules"
          ],
          "default": "vendor",
          "description": "How to group rules in the tree view. Category groups by compliance framework (NIST, PCI-DSS, etc.) if rules have category metadata."
        },
        "sentriflow.showTagsSection": {
          "type": "boolean",
          "default": true,
          "description": "Show 'By Tag' section in the rules tree view. This section groups rules by their typed tags (e.g., security: 'vlan-hopping', operational: 'performance'). Hidden automatically if no rules have tags."
        },
        "sentriflow.tagTypeFilter": {
          "type": "string",
          "enum": [
            "all",
            "security",
            "operational",
            "compliance",
            "general"
          ],
          "enumDescriptions": [
            "Show all tags regardless of type",
            "Show only security tags",
            "Show only operational tags",
            "Show only compliance tags",
            "Show only general tags"
          ],
          "default": "all",
          "description": "Filter tags by type in the 'By Tag' section. Choose 'all' to show all tags, or select a specific type."
        },
        "sentriflow.ipAddresses.filterSpecialRanges": {
          "type": "boolean",
          "default": false,
          "description": "Filter out special IP ranges (0.0.0.0, loopback, multicast, reserved, broadcast) from the IP Addresses view. When enabled, only shows public and private IP addresses."
        },
        "sentriflow.packs.enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable loading of external rule packs (.grx2, .grpx files)"
        },
        "sentriflow.packs.directory": {
          "type": "string",
          "default": "",
          "markdownDescription": "Directory to scan for rule packs (.grx2, .grpx files). Leave empty for platform default: `~/.sentriflow/packs` on Unix, `%USERPROFILE%\\.sentriflow\\packs` on Windows."
        },
        "sentriflow.packs.autoUpdate": {
          "type": "string",
          "enum": [
            "disabled",
            "on-activation",
            "daily",
            "manual"
          ],
          "enumDescriptions": [
            "Never check for updates automatically",
            "Check when extension activates",
            "Check once per day",
            "Only when manually triggered"
          ],
          "default": "on-activation",
          "description": "When to check for pack updates from cloud"
        },
        "sentriflow.packs.showInTree": {
          "type": "boolean",
          "default": true,
          "description": "Show external packs in the rules tree view"
        }
      }
    },
    "walkthroughs": [
      {
        "id": "sentriflow.welcome",
        "title": "Get Started with SentriFlow",
        "description": "Learn how to validate network configurations against compliance rules",
        "steps": [
          {
            "id": "openFile",
            "title": "Open a Configuration File",
            "description": "Open a network configuration file (.conf, .cfg, .ios, or .junos) to get started.\n\n[Open File](command:workbench.action.files.openFile)",
            "media": {
              "markdown": "Open any network device configuration file. SentriFlow will automatically detect the vendor and start scanning."
            },
            "completionEvents": [
              "onLanguage:network-config"
            ]
          },
          {
            "id": "scan",
            "title": "Scan for Compliance Issues",
            "description": "SentriFlow automatically scans your configuration. You can also manually trigger a scan.\n\n[Scan Now](command:sentriflow.scan)",
            "media": {
              "markdown": "Issues are shown as inline diagnostics in the editor and in the Problems panel."
            },
            "completionEvents": [
              "onCommand:sentriflow.scan"
            ]
          },
          {
            "id": "selectVendor",
            "title": "Select Your Vendor",
            "description": "SentriFlow auto-detects vendors, but you can override the selection if needed.\n\n[Select Vendor](command:sentriflow.selectVendor)",
            "media": {
              "markdown": "Choose from Cisco IOS/NX-OS, Juniper JunOS, Aruba, Arista, and more."
            },
            "completionEvents": [
              "onCommand:sentriflow.selectVendor"
            ]
          },
          {
            "id": "manageRules",
            "title": "Manage Rules",
            "description": "Browse and toggle rules in the SentriFlow sidebar. Enable or disable rules, vendors, or entire packs.\n\n[Open Rules Panel](command:sentriflow.focusRulesView)",
            "media": {
              "markdown": "The Rules TreeView shows all available rules organized by Pack > Vendor > Rule. Click the toggle icon to enable or disable."
            },
            "completionEvents": [
              "onView:sentriflowRules"
            ]
          },
          {
            "id": "customizeSettings",
            "title": "Customize Settings",
            "description": "Configure SentriFlow to match your environment using the Settings panel.\n\n[Open Settings](command:sentriflowSettings.focus)",
            "media": {
              "markdown": "The Settings panel provides a visual interface for all configuration options."
            },
            "completionEvents": [
              "onView:sentriflowSettings"
            ]
          }
        ]
      }
    ]
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/sentriflow/sentriflow.git"
  },
  "scripts": {
    "build": "bun build.mjs",
    "build:dev": "bun build.mjs --dev",
    "watch": "bun build.mjs --watch --dev",
    "package": "bun run build && vsce package --no-dependencies"
  },
  "dependencies": {
    "node-machine-id": "1.1.12"
  },
  "devDependencies": {
    "@sentriflow/core": "workspace:*",
    "@sentriflow/rules-default": "workspace:*",
    "@types/node": "^20.0.0",
    "@types/vscode": "^1.80.0",
    "@vscode/vsce": "^3.7.1",
    "esbuild": "^0.27.0"
  }
}
