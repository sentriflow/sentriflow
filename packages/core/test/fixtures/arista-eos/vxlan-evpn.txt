! Arista EOS VXLAN EVPN Configuration
!
hostname arista-vxlan-leaf-01
!
vlan 10
   name WEB_SERVERS
!
vlan 20
   name APP_SERVERS
!
vlan 30
   name DB_SERVERS
!
vrf instance TENANT_A
   description Tenant A Production VRF
!
interface Loopback0
   description Router-ID
   ip address 192.168.255.1/32
!
interface Loopback1
   description VTEP Source
   ip address 192.168.254.1/32
!
interface Vxlan1
   vxlan source-interface Loopback1
   vxlan udp-port 4789
   vxlan vni 10010 vlan 10
   vxlan vni 10020 vlan 20
   vxlan vni 10030 vlan 30
   vxlan vni 50001 vrf TENANT_A
   vxlan flood vtep 192.168.254.2 192.168.254.3
!
interface Vlan10
   description WEB Servers SVI
   vrf TENANT_A
   ip address virtual 10.10.10.1/24
!
interface Vlan20
   description APP Servers SVI
   vrf TENANT_A
   ip address virtual 10.20.20.1/24
!
interface Vlan30
   description DB Servers SVI
   vrf TENANT_A
   ip address virtual 10.30.30.1/24
!
ip virtual-router mac-address 00:1c:73:00:00:99
!
router bgp 65001
   router-id 192.168.255.1
   no bgp default ipv4-unicast
   maximum-paths 4 ecmp 4
   neighbor SPINE peer group
   neighbor SPINE remote-as 65000
   neighbor SPINE send-community extended
   neighbor 10.0.0.2 peer group SPINE
   neighbor 10.0.0.6 peer group SPINE
   !
   vlan 10
      rd 192.168.255.1:10010
      route-target both 65001:10010
      redistribute learned
   !
   vlan 20
      rd 192.168.255.1:10020
      route-target both 65001:10020
      redistribute learned
   !
   vlan 30
      rd 192.168.255.1:10030
      route-target both 65001:10030
      redistribute learned
   !
   address-family evpn
      neighbor SPINE activate
   !
   address-family ipv4
      neighbor SPINE activate
      network 192.168.254.1/32
      network 192.168.255.1/32
   !
   vrf TENANT_A
      rd 192.168.255.1:50001
      route-target import evpn 65001:50001
      route-target export evpn 65001:50001
      redistribute connected
!
end
