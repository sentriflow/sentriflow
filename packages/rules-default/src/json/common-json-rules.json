{
  "$schema": "https://sentriflow.io/schemas/json-rules/v1.0.json",
  "version": "1.0",
  "meta": {
    "name": "Common JSON Rules",
    "description": "Vendor-agnostic JSON rules that apply to all device types",
    "author": "SentriFlow",
    "license": "Apache-2.0"
  },
  "rules": [
    {
      "id": "JSON-COMMON-001",
      "selector": "interface",
      "vendor": "common",
      "metadata": {
        "level": "info",
        "obu": "Network Engineering",
        "owner": "NetOps",
        "description": "Interfaces should have a description for documentation",
        "remediation": "Add a description to document the interface purpose and connection"
      },
      "check": {
        "type": "and",
        "conditions": [
          {
            "type": "helper",
            "helper": "isInterfaceDefinition",
            "args": [{ "$ref": "node" }]
          },
          {
            "type": "helper",
            "helper": "isShutdown",
            "args": [{ "$ref": "node" }],
            "negate": true
          },
          {
            "type": "child_not_exists",
            "selector": "description"
          }
        ]
      },
      "failureMessage": "Interface {nodeId} is missing documentation (description)"
    }
  ]
}
